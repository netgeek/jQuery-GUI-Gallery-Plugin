/*!
 *
 * GUI Gallery Overlay - supports images/videos/iframes
 * @version 3.6
 * @author Mario McBean
 * @url http://www.devgit.eu/
 * @requirements jQuery 1.9 or higher
 * @copyright 2014 DevGit.eu
 * Released under the MIT license
 *
 */
(function(e){e.fn.guiGallery=function(t){function l(){var t=document.getElementById("gui-overlay-body"),r=document.createElement("div"),l,c,h,p,d,v,m,g,y,b,w=false;r.className="gui-loading-gallery";r.innerHTML="<p>Loading...</p>";t.appendChild(r);if(!e("."+s+".current").next().is("."+s)||a==true){var E=e('[data-gallery-first="true"]');l=E.is('[data-type="iframe"]')||!/\.(png|jpg|jpeg|gif|bmp|ico|svg)$/gi.test(E.attr("href"))?"iframe":"img";c=E.is("[data-title]")?E.attr("data-title"):e.trim(E.find("img").attr("alt"))!==""&&E.find("img").attr("alt")!="undefined"?e.trim(E.find("img").attr("alt")):"";h=E.attr("href");p=E.is("[data-content]")?e.trim(E.attr("data-content")):"";e("."+s+".current").removeClass("current");E.addClass("current");e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').hide();a=false}else{l=e("."+s+".current").next().is('[data-type="iframe"]')||!/\.(png|jpg|jpeg|gif|bmp|ico|svg)$/gi.test(e("."+s+".current").next().attr("href"))?"iframe":"img";c=e("."+s+".current").next().is("[data-title]")?e("."+s+".current").next().attr("data-title"):e.trim(e("."+s+".current").next().find("img").attr("alt"))!==""&&e("."+s+".current").next().find("img").attr("alt")!="undefined"?e.trim(e("."+s+".current").next().find("img").attr("alt")):"";h=e("."+s+".current").next().attr("href");p=e("."+s+".current").next().is("[data-content]")?e.trim(e("."+s+".current").next().attr("data-content")):"";e("."+s+".current").removeClass("current").next().addClass("current");e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').show()}v=c?'<div class="panel-heading"><h3 class="panel-title">'+c+"</h3></div>":"";m=l==="iframe"?'<iframe src="'+h+'" data-media="new" id="guiGallery-new-panel-media"></iframe>':'<img src="'+h+'" alt="'+c+'" data-media="new" id="guiGallery-new-panel-media" />';y=p?'<div class="panel-body">'+p+"</div>":"";g=y.length>0?'<div class="gui-gallery-media">'+m+"</div>":m;b=document.createElement("div");b.className="panel";b.id="gui-new-content";b.innerHTML=v+g+y;document.body.appendChild(b);if(n.enableAutoplay&&typeof i!="undefined"&&i.is(".playing")){f.pause()}e("#guiGallery-new-panel-media").on("load.guigallery",function(){var t=(window.innerHeight?window.innerHeight:e(window).innerHeight())-(c.length>0?152:113),r=(window.innerWidth?window.innerWidth:e(window).innerWidth())-120,a=this.offsetHeight,h=this.offsetWidth,d,v,m;u=a;if(l==="img"&&a>t&&p===""&&!w){if(!t>r){this.style.height=t+"px";this.style.width="auto"}else if(t>r){this.style.height="auto";this.style.width=r+"px"}else{this.style.height=t+"px"}}else if(l==="iframe"){if(p===""){this.style.width=r+"px";this.style.height=t+"px"}else if(p.length>0){this.style.height=t+"px";this.style.width=r-this.parentNode.nextSibling.offsetWidth+"px"}}if(l==="img"&&p===""&&u>t&&!w){e('.gui-overlay-content[data-rel="'+o+'"] .expand.gui-btn').removeAttr("style")}else{e('.gui-overlay-content[data-rel="'+o+'"] .expand.gui-btn').hide()}v=document.getElementById("gui-new-content");m=document.getElementById("gui-overlay-body");if(!w){m.parentNode.replaceChild(v,m);v=document.getElementById("gui-new-content");v.removeAttribute("id");v.id="gui-overlay-body";v=document.getElementById("guiGallery-new-panel-media");v.removeAttribute("id")}a=this.offsetHeight;if(l==="img"&&a<t&&!w){if(p.length>0){this.parentNode.parentNode.parentNode.style.top="50%";this.parentNode.parentNode.parentNode.style.marginTop=-((a+(c.length>0?59:20))/2)+"px"}else{this.parentNode.parentNode.style.top="50%";this.parentNode.parentNode.style.marginTop=-((a+(c.length>0?59:20))/2)+"px"}}else{if(p.length>0){this.parentNode.parentNode.parentNode.removeAttribute("style")}else{this.parentNode.parentNode.removeAttribute("style")}}if(n.enableAutoplay&&typeof i!="undefined"&&i.is(".paused")&&!w){f.resume()}if(!e("."+s+".current").next().is("."+s)&&!w){if(n.enableAutoplay&&typeof i!="undefined"&&i.is(".playing")){f.stop()}}if(typeof n.afterChange=="function"&&!w){n.afterChange.call(this);w=true}})}function c(){var t=document.getElementById("gui-overlay-body"),r=document.createElement("div"),i,a,f,l,c,h,p,d,v,m,g=false;r.className="gui-loading-gallery";r.innerHTML="<p>Loading...</p>";t.appendChild(r);if(!e("."+s+".current").prev().is("."+s)){var y=e('[data-gallery-last="true"]');i=y.is('[data-type="iframe"]')||!/\.(png|jpg|jpeg|gif|bmp|ico|svg)$/gi.test(y.attr("href"))?"iframe":"img";a=y.is("[data-title]")?y.attr("data-title"):e.trim(y.find("img").attr("alt"))!==""&&y.find("img").attr("alt")!="undefined"?e.trim(y.find("img").attr("alt")):"";f=y.attr("href");l=y.is("[data-content]")?e.trim(y.attr("data-content")):"";e("."+s+".current").removeClass("current");y.addClass("current");e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').show()}else{i=e("."+s+".current").prev().is('[data-type="iframe"]')||!/\.(png|jpg|jpeg|gif|bmp|ico|svg)$/gi.test(e("."+s+".current").prev().attr("href"))?"iframe":"img";a=e("."+s+".current").prev().is("[data-title]")?e("."+s+".current").prev().attr("data-title"):e.trim(e("."+s+".current").prev().find("img").attr("alt"))!==""&&e("."+s+".current").prev().find("img").attr("alt")!="undefined"?e.trim(e("."+s+".current").prev().find("img").attr("alt")):"";f=e("."+s+".current").prev().attr("href");l=e("."+s+".current").prev().is("[data-content]")?e.trim(e("."+s+".current").prev().attr("data-content")):"";e("."+s+".current").removeClass("current").prev().addClass("current");e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').show()}h=a?'<div class="panel-heading"><h3 class="panel-title">'+a+"</h3></div>":"";p=i==="iframe"?'<iframe src="'+f+'" data-media="new" id="guiGallery-new-panel-media"></iframe>':'<img src="'+f+'" alt="'+a+'" data-media="new" id="guiGallery-new-panel-media" />';v=l?'<div class="panel-body">'+l+"</div>":"";d=v.length>0?'<div class="gui-gallery-media">'+p+"</div>":p;m=document.createElement("div");m.className="panel";m.id="gui-new-content";m.innerHTML=h+d+v;document.body.appendChild(m);e("#guiGallery-new-panel-media").on("load.guigallery",function(){var t=(window.innerHeight?window.innerHeight:e(window).innerHeight())-(a.length>0?152:113),r=(window.innerWidth?window.innerWidth:e(window).innerWidth())-120,s=this.offsetHeight,f=this.offsetWidth,c,h;u=s;if(i==="img"&&s>t&&l===""&&!g){if(!t>r){this.style.height=t+"px";this.style.width="auto"}else if(t>r){this.style.height="auto";this.style.width=r+"px"}else{this.style.height=t+"px"}}else if(i==="iframe"){if(l===""){this.style.width=r+"px";this.style.height=t+"px"}else if(l.length>0){this.style.height=t+"px";this.style.width=r-this.parentNode.nextSibling.offsetWidth+"px"}}if(i==="img"&&l===""&&u>t&&!g){e('.gui-overlay-content[data-rel="'+o+'"] .expand.gui-btn').removeAttr("style")}else{e('.gui-overlay-content[data-rel="'+o+'"] .expand.gui-btn').hide()}c=document.getElementById("gui-new-content");h=document.getElementById("gui-overlay-body");if(!g){h.parentNode.replaceChild(c,h);c=document.getElementById("gui-new-content");c.removeAttribute("id");c.id="gui-overlay-body";c=document.getElementById("guiGallery-new-panel-media");c.removeAttribute("id")}s=this.offsetHeight;if(i==="img"&&s<t&&!g){if(l.length>0){this.parentNode.parentNode.parentNode.style.top="50%";this.parentNode.parentNode.parentNode.style.marginTop=-((s+(a.length>0?59:20))/2)+"px"}else{this.parentNode.parentNode.style.top="50%";this.parentNode.parentNode.style.marginTop=-((s+(a.length>0?59:20))/2)+"px"}}else{if(l.length>0){this.parentNode.parentNode.parentNode.removeAttribute("style")}else{this.parentNode.parentNode.removeAttribute("style")}}if(typeof n.afterChange=="function"&&!g){n.afterChange.call(this);g=true}});if(e("."+s+".current").is("[data-gallery-first]")){e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').hide()}}var n=e.extend(true,{},e.fn.guiGallery.defaults,t),r,i,s=e(this).attr("class"),o=document.location.href+"?="+s+"#"+this.length,u,a=false,f={};if(typeof n.autoplaySpeed=="number"&&n.autoplaySpeed<2e3||typeof n.autoplaySpeed!="number"&&/[^\d]/g.test(n.autoplaySpeed)){n.autoplaySpeed=2e3}else if(typeof n.autoplaySpeed!="number"&&/\d/g.test(n.autoplaySpeed)){if(n.autoplaySpeed<2e3){n.autoplaySpeed=2e3}else{n.autoplaySpeed=parseInt(n.autoplaySpeed,10)}}this.on(n.action,function(t){t.preventDefault();var r=e(this),h=r.parent().children().is("."+s)&&r.parent().children().length>1?true:false,p=false,d=r.is("[data-title]")?'<div class="panel-heading"><h3 class="panel-title">'+r.attr("data-title")+"</h3></div>":r.find("img").attr("alt")!="undefined"&&r.find("img").attr("alt")!=false&&e.trim(r.find("img").attr("alt"))!==""?'<div class="panel-heading"><h3 class="panel-title">'+e.trim(r.find("img").attr("alt"))+"</h3></div>":"",v=r.is("[data-content]")?'<div class="panel-body">'+e.trim(r.attr("data-content"))+"</div>":"",m=r.is('[data-type="iframe"]')||!/\.(png|jpg|jpeg|gif|bmp|ico|svg)$/gi.test(r.attr("href"))?v!==""?'<div class="gui-gallery-media"><iframe src="'+r.attr("href")+'" id="guiGallery-initial-panel-media" data-media="iframe"></iframe></div>':'<iframe src="'+r.attr("href")+'" id="guiGallery-initial-panel-media" data-media="iframe"></iframe>':v!==""?'<div class="gui-gallery-media"><img src="'+r.attr("href")+'" alt="" id="guiGallery-initial-panel-media" data-media="img" /></div>':'<img src="'+r.attr("href")+'" alt="" id="guiGallery-initial-panel-media" data-media="img" />',g=/(<img)/gi.test(m)?"img":/(<iframe)/gi.test(m)?"iframe":"",y='<div class="gui-overlay" data-rel="'+o+'"><div class="gui-loading" data-rel="'+o+'"><p>Loading...</p></div></div>'+'<div class="gui-overlay-content" id="gui-overlay-content" data-rel="'+o+'" style="top:5000px;"><div class="gui-panel" id="gui-panel">'+'<div class="gui-btn-holder-top">'+(n.enableSharing?'<div class="share gui-btn"><div class="gui-share-drop"><div class="facebook social-media-site" title="Share on Facebook"></div><div class="twitter social-media-site" title="Share on Twitter"></div><div class="googleplus social-media-site" title="Share on Google +"></div><div class="linkedin social-media-site" title="Share on Linkedin"></div><div class="pinterest social-media-site" title="Share on Pinterest"></div></div></div>':"")+'<div class="close gui-btn" title="Close"></div>'+"</div>"+(n.enableExpand||n.enableAutoplay?'<div class="gui-btn-holder-bottom">'+(n.enableExpand?'<div class="expand gui-btn" title="Expand" style="display:none;"></div>':"")+(n.enableAutoplay&&h?'<div class="rewind gui-btn" title="Go to first slide" style="display:none;"></div><div class="auto-play gui-btn" title="Auto Play"></div>':"")+"</div>":"")+(h?'<div class="left"><span class="gui-prev"></span></div><div class="right"><span class="gui-next"></span></div>':"")+'<div class="panel" id="gui-overlay-body">'+d+m+v+"</div>"+"</div></div>";e("body").append(y);r.addClass("current");e("#guiGallery-initial-panel-media").on("load.guigallery",function(){var t=(window.innerHeight?window.innerHeight:e(window).innerHeight())-(d.length>0?152:113),r=this.offsetHeight,i=(window.innerWidth?window.innerWidth:e(window).innerWidth())-120,s=this.offsetWidth;u=r;if(g==="img"&&r>t&&v===""){if(!t>i){this.style.height=t+"px";this.style.width="auto"}else if(t>i){this.style.height="auto";this.style.width=i+"px"}else{this.style.height=t+"px"}}else if(g==="iframe"){if(v===""){this.style.width=i+"px";this.style.height=t+"px"}else if(v.length>0){this.style.height=t+"px";this.style.width=i-this.parentNode.nextSibling.offsetWidth+"px"}}if(n.enableExpand){if(g==="img"&&u>t){e('.gui-overlay-content[data-rel="'+o+'"] .expand.gui-btn').removeAttr("style")}e('.gui-overlay-content[data-rel="'+o+'"] .expand.gui-btn').on("click.guigallery",function(){var t=window.innerWidth?window.innerWidth:e(window).innerWidth(),n=window.innerHeight?window.innerHeight:e(window).innerHeight();if(u>n){u=n-100}document.getElementById("gui-panel").removeAttribute("style");e(this).hide();if(t>n){e('.gui-overlay-content[data-rel="'+o+'"] .gui-panel .panel').find("img").css({width:t-100,height:"auto"})}else{e('.gui-overlay-content[data-rel="'+o+'"] .gui-panel .panel').find("img").css({height:u,width:"auto"})}})}if(g==="img"&&r<t){if(v.length>0){this.parentNode.parentNode.parentNode.style.top="50%";this.parentNode.parentNode.parentNode.style.marginTop=-((r+(d.length>0?59:20))/2)+"px"}else{this.parentNode.parentNode.style.top="50%";this.parentNode.parentNode.style.marginTop=-((r+(d.length>0?59:20))/2)+"px"}}e('.gui-overlay-content[data-rel="'+o+'"]').animate({top:"3000px",top:"1000px",top:"0"},750,function(){e('.gui-loading[data-rel="'+o+'"]').remove();if(typeof n.open=="function"&&!p){n.open.call(this);p=true}})});e('.gui-overlay-content[data-rel="'+o+'"] .gui-panel .close.gui-btn').on("click.guigallery",function(){e(document).off(".guigallery");e('.gui-overlay-content[data-rel="'+o+'"]').animate({top:"-1800px"},750,function(){e('.gui-overlay[data-rel="'+o+'"]').fadeOut(750).promise().done(function(){e(this).remove();e('.gui-overlay-content[data-rel="'+o+'"]').remove();e("."+s+".current").removeClass("current");if(e("."+s).parent().find("."+s).length>1){e("."+s).removeAttr("data-gallery-first data-gallery-last")}if(typeof n.close=="function"){n.close.call(this)}if(n.enableAutoplay&&typeof i!="undefined"){f.stop()}})})});e(document).on("keyup.guigallery",function(t){var n=t.keyCode?t.keyCode:t.which;if(n==27){e('.gui-overlay-content[data-rel="'+o+'"] .gui-panel .close.gui-btn').trigger("click")}if(h){if(n==37){c()}if(n==39){l()}}});if(h){e("."+s+".current").parent().find("."+s+":first").attr("data-gallery-first","true");e("."+s+".current").parent().find("."+s+":last").attr("data-gallery-last","true");e('.gui-overlay-content[data-rel="'+o+'"]').find(".left, .right, .auto-play.gui-btn, .rewind.gui-btn").on("click.guigallery",function(){if(e(this).is(".left")){c()}if(e(this).is(".right")){l()}if(e(this).is(".auto-play.gui-btn")){var t=e('.gui-overlay-content[data-rel="'+o+'"] .auto-play.gui-btn').is(".playing")?true:false;i=e('.gui-overlay-content[data-rel="'+o+'"] .auto-play.gui-btn');if(t){f.stop()}else{f.play()}}if(e(this).is(".rewind.gui-btn")){a=true;l();if(n.enableAutoplay&&typeof i!="undefined"&&i.is(".playing")){f.stop()}e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').fadeOut("fast").promise().done(function(){e(this).addClass("is_hidden")})}});if(!e("."+s+".current").is("[data-gallery-first]")){e('.gui-overlay-content[data-rel="'+o+'"] .rewind.gui-btn').removeAttr("style")}}if(n.enableSharing){e('.gui-overlay-content[data-rel="'+o+'"] .gui-panel .share .gui-share-drop .social-media-site').on("click.guigallery",function(){var t=e('.gui-overlay-content[data-rel="'+o+'"] [data-media]')[0].src,n=e(this).is(".facebook")?"facebook":e(this).is(".twitter")?"twitter":e(this).is(".linkedin")?"linkedin":e(this).is(".pinterest")?"pinterest":e(this).is(".googleplus")?"googleplus":"",r=encodeURIComponent(t),i=e('.gui-overlay-content[data-rel="'+o+'"] .panel').find("h3").is(".panel-title")?encodeURIComponent(e('.gui-overlay-content[data-rel="'+o+'"] .panel .panel-title').text()):encodeURIComponent(document.title),s=e('.gui-overlay-content[data-rel="'+o+'"] .panel').find("div").is(".panel-body")?e('.gui-overlay-content[data-rel="'+o+'"] .panel .panel-body').text():i,u=encodeURIComponent(location.href);if(s.length>100){s=s.substring(0,97)+"..."}switch(n){case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u="+r,"_blank","menubar=no,fullscreen=no,height=313,width=675,top=0,left=0",false);break;case"twitter":window.open("https://twitter.com/intent/tweet?text="+s+"&url="+r,"_blank","menubar=no,fullscreen=no,height=450,width=550,top=0,left=0,resizable=yes",false);break;case"linkedin":window.open("http://www.linkedin.com/shareArticle?mini=true&url="+r+"&title="+i+"&summary="+s+"&source="+u,"_blank","menubar=no,fullscreen=no,height=408,width=600,top=0,left=0,resizable=yes",false);break;case"pinterest":window.open("http://pinterest.com/pin/create/button/?url"+u+"&media="+r+"&description="+s,"_blank","menubar=no,fullscreen=no,height=570,width=520,top=0,left=0,resizable=yes",false);break;case"googleplus":window.open("https://plus.google.com/share?url="+r,"_blank","toolbar=no,menubar=no,fullscreen=no,height=344,width=568,top=0,left=0,resizable=yes",false);break}})}});f.play=function(){r=setInterval(function(){l()},n.autoplaySpeed);i.addClass("active playing")};f.stop=function(){clearInterval(r);i.removeClass("active playing")};f.pause=function(){clearInterval(r);i.addClass("paused").removeClass("active playing")};f.resume=function(){r=setInterval(function(){l()},n.autoplaySpeed);i.removeClass("paused").addClass("active playing")};return this};e.fn.guiGallery.defaults={action:"click",open:e.noop,close:e.noop,beforeChange:e.noop,afterChange:e.noop,enableAutoplay:true,autoplaySpeed:2500,enableExpand:true,enableSharing:true}})(jQuery)